# BufferOverflowExploit
Buffer overflow exploit

CyberSecurity, RomaTre 2023/24
http://cysec.pizzonia.it/

Example given for x86, reworked for ARM (Raspberry Pi 3, and Pi 4 with some issue)

---- Italian ----

x86:
  Codice messo a disposizione dal docente [http://www.dia.uniroma3.it/~pizzonia/cysec/study/software/buffer_overflow_example_20171025.tar.gz].
  Test eseguito su live Kali Linux in VmWare (20231101).
  Tutto ha funzionato praticamente subito, dopo aver disabilitato ASLR...

ARM:
  Porting del progetto x86, in cui ho dovuto cambiare l'eseguibile lanciato dall'exploit, in quanto gli nc installati sui Raspberry Pi 3 e 4 non supportavano l'opzione -c, così ho trovato che installando nc6 potevo aggirare.
  Per il Raspberry Pi 3 è bastato disabilitare ASLR, mentre per il Raspberry Pi 4 ho dovuto disabilitare anche i canaries (CFLAGS=-g -Wl,-z,norelro -fno-stack-protector -z execstack)... sarebbe da provare gdb ./target compilato con la protezione dello stack...
  
  Nella prima versione del porting il codice andava a modificare il codice macchina stesso, infatti nel .S c'era "add r0, r4, r0" che veniva a runtime trasformata in "add r2, r4, r0". Quest'ultima istruzione ha 0x20 nel codice macchina che fermerebbe la scanf(). Questo vecchio codice comportava che spesso il Raspberry Pi 3 dava "Errore di segmentazione" e a volte andava, mentre il Pi 4 funzionava solo con gdb...

  Poi ho trovato che potevo usare istruzioni che mi permettevano di caricare il registro r2 (che equivale al ruolo di EDX nella system call in x86) senza che fosse generato un byte 0x20 nel codice macchina (push {r0, r1}  e pop {r2, r1} invece che mov r2, r0):
  con questa modifica l'exploit per il Raspberry Pi 3 sembra funzionare sempre, mentre lo stesso exploit (a parte il fakerp) sul Raspberry Pi 4 da spesso "Istruzione non consentita" ma a volte funziona (resta da indagare perché...).
  
  L'evidenza degli attacchi sono nei file che terminano per _OK.txt (ho usato una riga di '-' come separatore) nelle rispettive cartelle ARM.
---- Italian ----
